# docker image & container

## 도커 이미지와 컨테이너

1. 도커 이미지 
    - 도커 이미지는 컨테이너를 생성할때 필요하며, 가상머신으로는 ISO파일과 비슷한 개념입니다.
    - 이미지는 도커 명령어로 내려받을 수 있으며 별도로 설치가 필요없다.
    - 도커에서 사용 하는 이미지의 이름은 기본적으로 [저장소이름]/[이미지이름]:태그 형태로 구성된다. ex) ubuntu:latest:14.04
        - 저장소 : 이미지가 저장된 장소, 저장소 이름이 명시되지 않으면 기본적으로 도커 허브의 공식 이미지
        - 이미지 이름 : 간단히 해당 이미지 구분지을때 사용됨, 반드시 필요함
        - 태그 : 버전관리 혹은 리비전 관리에 사용됨

2. 도커 컨테이너
    - 도커 이미지는 윈도우, 리눅스, 우분투 등 기본적인 운영체제부터 아파치, mysql등 다양한 애플리케이션 종류가 있는데, 이러한 이미지를 사용하여 컨테이너를 생성하면 해당 이미지의 목적에 맞는 파일이 들어있는 파일시스템과 격리된 자원 네트워크를 사용할 수 있는 독립된 공간이 생성됩니다. 이를 컨테이너라고 부릅니다.
    - 도커 컨테이너는 이미지의 종류에 따라 알맞은 설정과 파일을 가지고 있다.
    - ☆ 컨테이너는 이미지를 읽기 전용으로 사용하되 이미지에서 변경된 사항만 컨테이너 계층에 저장하므로 컨테이너에서 무엇을 하든지 원래 이미지는 영향이 없다. 
    - 또한 각 생성된 각 컨테이너는 각기 독립된 파일 시스템을 제공 받으며 호스트와 분리돼 있으므로 특정 컨테이너에서 어떤 애플리케이션이을 설치하거나 삭제해도 다른 컨테이너와 호스트는 변화가 없습니다.(즉, 이미지를 통해 컨테이너를 설치했을때 고립된 환경이므로 무엇을 바꾸든 해당 컨테이너 내용에서만 바뀌게 됨, 이미지나 다른 컨테이너에서는 영향X) -> 도커특징

3. 도커 컨테이너 생성
    - docker -v : 버전 
    - docker run -i -t ubuntu:14.04 : 내부에 도커 이미지가 없다면 도커 허브에서 검색해서 컨테이너를 생성하고 실행시킴(ㄷㄷ)
        - 기본 사용자는 Root이고 호스트 이름은 무작위 16진수 해쉬값
        - [-i] 옵션은 입출력, [-t] 옵션은 tty 활성화 이 두 옵션을 사용하여 배시 셸을 사용하도록 컨테이너 설정. (ps, 이 옵션을 사용해야만 셸을 정상적으로 사용할 수 있다.)
        - 도커 종료 : exit or ctrl + D, 컨테이너를 빠져나오면서 정지를 시킨다.
        - 도커 종료 2 : ctrl + p,q, 컨테이너 셸에서만 빠져나온다.
    - docker pull centos:7 : centos버전 7 이미지를 도커허브에서 다운
    - docker images : 로컬 다운로드된 이미지 목록 출력
    - docker create -i -t --name topImage centos:7 : 도커 컨테이너 생성만 함.
        - 도커 컨테이너를 생성할땐 run 말고도 create가 있다.
        - [--name] 명령어는 컨테이너의 이름을 설정한다.
    - docker start [컨테이너-이름] : 컨테이너 시작
    - docker attach [컨테이너-이름] : 쉘 접속
    - docker ps : 컨테이너 목록 확인
    - docker stop [컨테이너-이름] : 활성화 컨테이너 종료

4. 도커 컨테이너 삭제
    - docker rm [컨테이너-이름] : 컨테이너 삭제 (-f 옵션이 없다면 종류 삭제해야 된다)
    - docker container prune : 컨테이너 전체 삭제

5. 도커 컨테이너를 외부에 노출
    - docker [-p [호스트-포트]:[컨테이너:포트]] : -p 옵션은 컨테이너 포트를 호스트 포트와 바인딩해 연결할 수 있게 하는 설정

6. 도커 컨테이너 애플리케이션 구축(신기.. 그자체)
    - docker [-d] : -i,-t 옵션이 컨테이너 내부로 진입하도록 attach 가능한 상태로 설정한다면 -d는 Detached모드로 컨테이너를 실행한다. 백그라운드에서 동작하는 애플리케이션으로 실행하도록 설정. 반드시 컨테이너에서 프로그램이 실행되어야 한다. 아니면 종료된다.
    - docker [-e] : 컨테이너 내부의 환경변수를 설정. 컨테이너화된 애플리케이션은 환경변수에서 값을 가져와 쓰는 경우가 많으므로 자주 사용하는 옵션 중 하나.
    - docker [--link] : deprecated, 도커 브리지를 사용하자.
        - 설명 : A컨테이너에서 B컨테이너로 접근하는 방법 중 가장 간단한 -NAT 할당받은 내부 IP사용, 해당 옵션은 내부 IP가 필요 없이 항상 컨테이너 이름(별명 alias)으로 접근하도록 설정한다. 또한 컨테이너 이름이 없거나 실해중인 상태가 아니라면 실행 할 수 없다. 컨테이너 실행 순서의 의존성도 어느정도 정의해준다.
        